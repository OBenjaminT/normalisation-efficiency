CREATE TABLE IF NOT EXISTS yeargroup (YearID Text PRIMARY KEY, Name Text, NationalCurriculumYear Text, Code Text, HeadOfYear Text, AssistantHeadOfYear Text, FOREIGN KEY (HeadOfYear) REFERENCES users(Username), FOREIGN KEY (AssistantHeadOfYear) REFERENCES users(Username));
CREATE TABLE IF NOT EXISTS year (yearID Integer PRIMARY KEY, StartYear Text, EndYear Text, StartDate Text, EndDate Text, CurrentYear Integer, TermsTermID Integer, TermsName Text, TermsStartDate Text, TermsEndDate Text);
CREATE TABLE IF NOT EXISTS users (Firstname Text, Surname Text, YearGroup Text, Middlename Text, Preferredname Text, Username Text PRIMARY KEY, Status Text, Year Integer, Email Text, SchoolID Text, IsamsID Text, IsamsCode Text, Title Text, LastActive Text, PupilType Text, AcademicStudy Text, Positions Text, ExpoID Text, Archived Integer DEFAULT 0, House Text, Roles Text, FOREIGN KEY (YearGroup) REFERENCES yeargroup(YearID), FOREIGN KEY (House) REFERENCES house(HouseID), FOREIGN KEY (Roles) REFERENCES role(Name), FOREIGN KEY (Username) REFERENCES tutorGroup(Students), FOREIGN KEY (Username) REFERENCES Sets(Students), FOREIGN KEY (Username) REFERENCES prep(DueForUser), FOREIGN KEY (Username) REFERENCES lesson(Students));
CREATE TABLE IF NOT EXISTS tutorGroup (Name Text PRIMARY KEY, Tutors Text, Students Text, AcademicYear Text, Year Text, Archived Integer DEFAULT 0, House Text, FOREIGN KEY (Tutors) REFERENCES users(Username), FOREIGN KEY (AcademicYear) REFERENCES year(yearID), FOREIGN KEY (House) REFERENCES house(HouseID));
CREATE TABLE IF NOT EXISTS subject (SubjectID Text PRIMARY KEY, Department Text, Name Text, Code Text, ReportName Text, FOREIGN KEY (Department) REFERENCES department(DepartmentID));
CREATE TABLE IF NOT EXISTS Sets (SetsID Text PRIMARY KEY, Subject Text, Name Text, Year Text, Archived Integer DEFAULT 0, Teacher Text, Students Text, YearGroup Text, FOREIGN KEY (Subject) REFERENCES subject(SubjectID), FOREIGN KEY (Year) REFERENCES year(yearID), FOREIGN KEY (Teacher) REFERENCES users(Username), FOREIGN KEY (YearGroup) REFERENCES yeargroup(YearID));
CREATE TABLE IF NOT EXISTS room (Building Text, Code Text PRIMARY KEY, Name Text, Initials Text, FOREIGN KEY (Building) REFERENCES building(BuildingID));
CREATE TABLE IF NOT EXISTS role (Name Text PRIMARY KEY, Auth Text, Type Text);
CREATE TABLE IF NOT EXISTS prep (Sets Text, DueLesson Text, Title Text PRIMARY KEY, Description Text, CreatedAt Text, DueAt Text, DueForCompleted Integer DEFAULT 0, DueForUpdatedAt Text, DueFor Text, Personal Integer, LastEditedAt Text, AssignedDate Text, Archived Integer DEFAULT 0, DueForUser Text, AssignedBy Text, Files Text, FOREIGN KEY (Sets) REFERENCES Sets(SetsID), FOREIGN KEY (DueLesson) REFERENCES lesson(lessonID), FOREIGN KEY (AssignedBy) REFERENCES users(Username));
CREATE TABLE IF NOT EXISTS period (PeriodID Text PRIMARY KEY, Day Text, StartTime Text, EndTime Text, LongName Text, ShortName Text, Week Text);
CREATE TABLE IF NOT EXISTS notification (Sender Text, RecipientsUser Text, Title Text PRIMARY KEY, Message Text, RecipientsRead Integer, RecipientsReadAt Text, SentAt Text, MetaPage Text, MetaParam Text, FOREIGN KEY (Sender) REFERENCES users(Username), FOREIGN KEY (RecipientsUser) REFERENCES users(Username));
CREATE TABLE IF NOT EXISTS module (CreatedBy Text, Name Text PRIMARY KEY, Icon Text, Link Text, ExternalMod Integer, Colour Text, ShowFor Text, PreviewTitle Text, PreviewSubtitle Text, PreviewLink Text, Staff Integer, New Integer DEFAULT 0, FOREIGN KEY (CreatedBy) REFERENCES users(Username));
CREATE TABLE IF NOT EXISTS lesson (lessonID Integer PRIMARY KEY, Sets Text, Archived Integer DEFAULT 0, Subject Text, Start Text, Room Text, EndTime Text, Period Text, Teacher Text, Students Text, FOREIGN KEY (Sets) REFERENCES Sets(SetsID), FOREIGN KEY (Subject) REFERENCES subject(SubjectID), FOREIGN KEY (Room) REFERENCES room(Code), FOREIGN KEY (Period) REFERENCES period(PeriodID), FOREIGN KEY (Teacher) REFERENCES users(Username), FOREIGN KEY (Archived) REFERENCES lesson(Sets));
CREATE TABLE IF NOT EXISTS house (Name Text PRIMARY KEY, Code Text, Type Text, Housemaster Text, AssistantHousemaster Text, Logo Text, HouseID Text, FOREIGN KEY (Housemaster) REFERENCES users(Username), FOREIGN KEY (AssistantHousemaster) REFERENCES users(Username));
CREATE TABLE IF NOT EXISTS files (fileID Integer PRIMARY KEY, UploadedBy Text, S3Key Text, ContentType Text, FileName Text, Title Text, UploadedAt Text, FOREIGN KEY (fileID) REFERENCES prep(Files), FOREIGN KEY (UploadedBy) REFERENCES users(Username));
CREATE TABLE IF NOT EXISTS department (DepartmentID Text PRIMARY KEY, Name Text, HeadOfDepartment Text, FOREIGN KEY (HeadOfDepartment) REFERENCES users(Username));
CREATE TABLE IF NOT EXISTS building (BuildingID Text PRIMARY KEY, Name Text, Initials Text, Description Text);